# ğŸ“± DoAi.Me ë””ë°”ì´ìŠ¤ ê³„ì¸µ êµ¬ì¡°

> í°ë³´ë“œ-ìŠ¬ë¡¯ ê¸°ë°˜ 300ëŒ€ ë””ë°”ì´ìŠ¤ ê´€ë¦¬ ì²´ê³„

---

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#1-ê°œìš”)
2. [ê³„ì¸µ êµ¬ì¡°](#2-ê³„ì¸µ-êµ¬ì¡°)
3. [ëª…ëª… ê·œì¹™](#3-ëª…ëª…-ê·œì¹™)
4. [ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ](#4-ë°ì´í„°ë² ì´ìŠ¤-ìŠ¤í‚¤ë§ˆ)
5. [ê·¸ë£¹ ì‹œìŠ¤í…œ](#5-ê·¸ë£¹-ì‹œìŠ¤í…œ)
6. [ìƒíƒœ ê´€ë¦¬](#6-ìƒíƒœ-ê´€ë¦¬)
7. [API ì‚¬ìš©ë²•](#7-api-ì‚¬ìš©ë²•)

---

## 1. ê°œìš”

DoAi.MeëŠ” **300ëŒ€**ì˜ Android ê¸°ê¸°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•´ **3ë‹¨ê³„ ê³„ì¸µ êµ¬ì¡°**ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

```
ì›Œí¬ìŠ¤í…Œì´ì…˜ (5ëŒ€)
    â””â”€ í°ë³´ë“œ (ì›Œí¬ìŠ¤í…Œì´ì…˜ë‹¹ 3ëŒ€)
        â””â”€ ìŠ¬ë¡¯ (í°ë³´ë“œë‹¹ 20ëŒ€)

ì´ê³„: 5 Ã— 3 Ã— 20 = 300ëŒ€
```

### ì™œ ì´ êµ¬ì¡°ì¸ê°€?

| ì´ìœ  | ì„¤ëª… |
|------|------|
| **ë¬¼ë¦¬ì  ë§¤í•‘** | ì‹¤ì œ í•˜ë“œì›¨ì–´ ë°°ì¹˜ì™€ 1:1 ë§¤ì¹­ |
| **ì¥ì•  ê²©ë¦¬** | í°ë³´ë“œ ë‹¨ìœ„ë¡œ ì¥ì•  ê²©ë¦¬ ê°€ëŠ¥ |
| **ë¶€í•˜ ë¶„ì‚°** | ì›Œí¬ìŠ¤í…Œì´ì…˜ë³„ ë…ë¦½ì  ê´€ë¦¬ |
| **í™•ì¥ì„±** | ì›Œí¬ìŠ¤í…Œì´ì…˜ ì¶”ê°€ë¡œ ìˆ˜í‰ í™•ì¥ |

---

## 2. ê³„ì¸µ êµ¬ì¡°

### ì „ì²´ êµ¬ì¡°

```
DoAi.Me Device Farm (300ëŒ€)
â”‚
â”œâ”€ WS01 (ì›Œí¬ìŠ¤í…Œì´ì…˜ 1) â”€â”€â”€ VLAN 1
â”‚  â”‚
â”‚  â”œâ”€ WS01-PB01 (í°ë³´ë“œ 1)
â”‚  â”‚  â”œâ”€ WS01-PB01-S01  â”‚  WS01-PB01-S02  â”‚  WS01-PB01-S03  â”‚ ...
â”‚  â”‚  â”œâ”€ WS01-PB01-S04  â”‚  WS01-PB01-S05  â”‚  WS01-PB01-S06  â”‚ ...
â”‚  â”‚  â”œâ”€ ...
â”‚  â”‚  â””â”€ WS01-PB01-S19  â”‚  WS01-PB01-S20
â”‚  â”‚
â”‚  â”œâ”€ WS01-PB02 (í°ë³´ë“œ 2)
â”‚  â”‚  â””â”€ [20 slots]
â”‚  â”‚
â”‚  â””â”€ WS01-PB03 (í°ë³´ë“œ 3)
â”‚     â””â”€ [20 slots]
â”‚
â”œâ”€ WS02 (ì›Œí¬ìŠ¤í…Œì´ì…˜ 2) â”€â”€â”€ VLAN 2
â”‚  â”œâ”€ WS02-PB01, WS02-PB02, WS02-PB03
â”‚  â””â”€ [60 devices total]
â”‚
â”œâ”€ WS03 (ì›Œí¬ìŠ¤í…Œì´ì…˜ 3) â”€â”€â”€ VLAN 3
â”œâ”€ WS04 (ì›Œí¬ìŠ¤í…Œì´ì…˜ 4) â”€â”€â”€ VLAN 4
â””â”€ WS05 (ì›Œí¬ìŠ¤í…Œì´ì…˜ 5) â”€â”€â”€ VLAN 5
```

### ë¬¼ë¦¬ì  ë°°ì¹˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ì›Œí¬ìŠ¤í…Œì´ì…˜ (WS01)                               â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    í°ë³´ë“œ 1 (PB01)                             â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”â”‚  â”‚
â”‚  â”‚  â”‚ S01 â”‚ S02 â”‚ S03 â”‚ S04 â”‚ S05 â”‚ S06 â”‚ S07 â”‚ S08 â”‚ S09 â”‚ S10 â”‚â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤â”‚  â”‚
â”‚  â”‚  â”‚ S11 â”‚ S12 â”‚ S13 â”‚ S14 â”‚ S15 â”‚ S16 â”‚ S17 â”‚ S18 â”‚ S19 â”‚ S20 â”‚â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    í°ë³´ë“œ 2 (PB02)                             â”‚  â”‚
â”‚  â”‚  [20 slots]                                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    í°ë³´ë“œ 3 (PB03)                             â”‚  â”‚
â”‚  â”‚  [20 slots]                                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                      â”‚
â”‚  [USB Hub ì—°ê²°]  [Laixi.exe ì‹¤í–‰]  [ADB Server]                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. ëª…ëª… ê·œì¹™

### í˜•ì‹

```
{ì›Œí¬ìŠ¤í…Œì´ì…˜ID}-{í°ë³´ë“œID}-{ìŠ¬ë¡¯ë²ˆí˜¸}
```

### ì˜ˆì‹œ

| Hierarchy ID | ì›Œí¬ìŠ¤í…Œì´ì…˜ | í°ë³´ë“œ | ìŠ¬ë¡¯ | Group |
|--------------|------------|--------|------|-------|
| `WS01-PB01-S01` | WS01 | 1 | 1 | A |
| `WS01-PB01-S02` | WS01 | 1 | 2 | B |
| `WS01-PB02-S15` | WS01 | 2 | 15 | A |
| `WS03-PB03-S20` | WS03 | 3 | 20 | B |

### íŒŒì‹±

```python
from shared.device_registry import DeviceRegistry

# Hierarchy ID íŒŒì‹±
result = DeviceRegistry.parse_hierarchy_id("WS01-PB02-S15")
# {
#     "workstation": "WS01",
#     "board": 2,
#     "slot": 15,
#     "phoneboard_id": "WS01-PB02"
# }
```

---

## 4. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### í…Œì´ë¸” êµ¬ì¡°

```sql
-- ì›Œí¬ìŠ¤í…Œì´ì…˜
workstations
â”œâ”€â”€ id (VARCHAR)         -- WS01, WS02...
â”œâ”€â”€ name                  -- ì´ë¦„
â”œâ”€â”€ ip_address            -- ë‚´ë¶€ IP
â”œâ”€â”€ vlan_id               -- VLAN ë²ˆí˜¸
â”œâ”€â”€ laixi_connected       -- Laixi ì—°ê²° ìƒíƒœ
â”œâ”€â”€ status                -- online/offline/error
â”œâ”€â”€ total_devices         -- ì´ ê¸°ê¸° ìˆ˜
â””â”€â”€ online_devices        -- ì˜¨ë¼ì¸ ê¸°ê¸° ìˆ˜

-- í°ë³´ë“œ
phoneboards
â”œâ”€â”€ id (VARCHAR)         -- WS01-PB01, WS01-PB02...
â”œâ”€â”€ workstation_id        -- FK â†’ workstations
â”œâ”€â”€ board_number          -- 1, 2, 3
â”œâ”€â”€ slot_count            -- ê¸°ë³¸ 20
â”œâ”€â”€ connected_count       -- ì—°ê²°ëœ ê¸°ê¸° ìˆ˜
â””â”€â”€ status                -- online/offline/partial

-- ë””ë°”ì´ìŠ¤ (í™•ì¥)
devices
â”œâ”€â”€ id (UUID)
â”œâ”€â”€ serial_number         -- ADB ì‹œë¦¬ì–¼
â”œâ”€â”€ workstation_id        -- FK â†’ workstations
â”œâ”€â”€ phoneboard_id         -- FK â†’ phoneboards
â”œâ”€â”€ slot_number           -- 1-20
â”œâ”€â”€ hierarchy_id          -- WS01-PB01-S05 (ìë™ ìƒì„±)
â”œâ”€â”€ device_group          -- A ë˜ëŠ” B (ìë™ í• ë‹¹)
â”œâ”€â”€ status                -- idle/busy/offline/error
â””â”€â”€ last_heartbeat
```

### ìë™ ìƒì„± íŠ¸ë¦¬ê±°

```sql
-- hierarchy_id ìë™ ìƒì„±
-- phoneboard_id + slot_number â†’ hierarchy_id
CREATE TRIGGER devices_hierarchy_id
    BEFORE INSERT OR UPDATE ON devices
    FOR EACH ROW EXECUTE FUNCTION generate_device_hierarchy_id();

-- ì˜ˆ: phoneboard_id='WS01-PB02', slot_number=15
-- â†’ hierarchy_id='WS01-PB02-S15'
```

---

## 5. ê·¸ë£¹ ì‹œìŠ¤í…œ

### A/B ê·¸ë£¹ ë¶„í• 

ë””ë°”ì´ìŠ¤ëŠ” **ìŠ¬ë¡¯ ë²ˆí˜¸**ì— ë”°ë¼ ìë™ìœ¼ë¡œ ê·¸ë£¹ì´ í• ë‹¹ë©ë‹ˆë‹¤:

```
Group A: í™€ìˆ˜ ìŠ¬ë¡¯ (S01, S03, S05, S07, S09, S11, S13, S15, S17, S19)
Group B: ì§ìˆ˜ ìŠ¬ë¡¯ (S02, S04, S06, S08, S10, S12, S14, S16, S18, S20)
```

### ê·¸ë£¹ ë¶„í•  ëª©ì 

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    50% ë°°ì¹˜ ì‹¤í–‰                                  â”‚
â”‚                                                                   â”‚
â”‚  1ì°¨ ì‹¤í–‰: Group A (150ëŒ€)                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ S01 â”‚ S03 â”‚ S05 â”‚ S07 â”‚ S09 â”‚ S11 â”‚ S13 â”‚ S15 â”‚ S17 â”‚ S19 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                        â”‚
â”‚                         â–¼ 60ì´ˆ ëŒ€ê¸°                              â”‚
â”‚                         â”‚                                        â”‚
â”‚  2ì°¨ ì‹¤í–‰: Group B (150ëŒ€)                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ S02 â”‚ S04 â”‚ S06 â”‚ S08 â”‚ S10 â”‚ S12 â”‚ S14 â”‚ S16 â”‚ S18 â”‚ S20 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì´ì 

| ì´ì  | ì„¤ëª… |
|------|------|
| **ë¶€í•˜ ë¶„ì‚°** | ë™ì‹œ ì ‘ì† 300ëŒ€ â†’ 150ëŒ€ë¡œ ê°ì†Œ |
| **ì˜¤ë¥˜ ê²©ë¦¬** | A ê·¸ë£¹ ì‹¤íŒ¨ ì‹œ B ê·¸ë£¹ ë³´ì¡´ |
| **ìì—°ìŠ¤ëŸ¬ìš´ íŒ¨í„´** | ì ì§„ì  íŠ¸ë˜í”½ ìƒì„± |
| **ì—´ ë¶„ì‚°** | ì¸ì ‘ ìŠ¬ë¡¯ ë™ì‹œ ì‹¤í–‰ ë°©ì§€ |

---

## 6. ìƒíƒœ ê´€ë¦¬

### ë””ë°”ì´ìŠ¤ ìƒíƒœ

| ìƒíƒœ | ì„¤ëª… | ì „ì´ ê°€ëŠ¥ ìƒíƒœ |
|------|------|---------------|
| `idle` | ëŒ€ê¸° ì¤‘, ì‘ì—… ê°€ëŠ¥ | busy, offline, error |
| `busy` | ì‘ì—… ì‹¤í–‰ ì¤‘ | idle, error, offline |
| `offline` | ì—°ê²° ëŠê¹€ | idle, error |
| `error` | ì˜¤ë¥˜ ìƒíƒœ | idle, offline, maintenance |
| `overheat` | ê³¼ì—´ ê°ì§€ | idle, maintenance |
| `maintenance` | ìœ ì§€ë³´ìˆ˜ ì¤‘ | idle, offline |

### ìƒíƒœ ì „ì´ ë‹¤ì´ì–´ê·¸ë¨

```
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   offline   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                         â”‚
                     â”‚ ì—°ê²°ë¨                         â”‚
                     â–¼                                â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      ì‘ì—… ì™„ë£Œ          â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â–¶â”‚    idle     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
      â”‚       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜               â”‚        â”‚
      â”‚              â”‚ ì‘ì—… í• ë‹¹            â”‚        â”‚
      â”‚              â–¼                      â”‚        â”‚
      â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚        â”‚
      â”‚       â”‚    busy     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
      â”‚       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                        â”‚
      â”‚              â”‚ ì˜¤ë¥˜ ë°œìƒ                      â”‚
      â”‚              â–¼                                â”‚
      â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”‚   error     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ ë³µêµ¬/ìœ ì§€ë³´ìˆ˜
                     â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ maintenance â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í•˜íŠ¸ë¹„íŠ¸

```python
# í•˜íŠ¸ë¹„íŠ¸ ë™ì‘
# - last_heartbeat ê°±ì‹ 
# - statusê°€ 'busy'ë©´ ìœ ì§€
# - statusê°€ 'busy' ì•„ë‹ˆë©´ 'idle'ë¡œ ë³€ê²½

await registry.heartbeat("WS01-PB01-S05")
```

---

## 7. API ì‚¬ìš©ë²•

### ë””ë°”ì´ìŠ¤ ë“±ë¡

```python
from shared.device_registry import get_device_registry

registry = get_device_registry()

# ë‹¨ì¼ ë“±ë¡
device = await registry.register_device(
    serial="ABC123",
    workstation="WS01",
    board=1,
    slot=5,
    model="Galaxy S9"
)
# â†’ DeviceInfo(hierarchy_id="WS01-PB01-S05", device_group="A", ...)
```

### ë””ë°”ì´ìŠ¤ ì¡°íšŒ

```python
# hierarchy_idë¡œ ì¡°íšŒ
device = await registry.get_device_by_hierarchy("WS01-PB01-S05")

# ì‹œë¦¬ì–¼ë¡œ ì¡°íšŒ
device = await registry.get_device_by_serial("ABC123")

# í•„í„° ì¡°íšŒ
devices = await registry.get_devices(
    workstation_id="WS01",      # íŠ¹ì • ì›Œí¬ìŠ¤í…Œì´ì…˜
    phoneboard_id="WS01-PB01",  # íŠ¹ì • í°ë³´ë“œ
    status="idle",              # ìƒíƒœ í•„í„°
    group="A",                  # ê·¸ë£¹ í•„í„°
    limit=50                    # ìµœëŒ€ ê°œìˆ˜
)
```

### ë°°ì¹˜ ê·¸ë£¹ ì¡°íšŒ

```python
# 50% ë°°ì¹˜ ì‹¤í–‰ìš© ê·¸ë£¹ ë¶„í• 
group_a, group_b = await registry.get_batch_groups(
    workstation_id="WS01"  # íŠ¹ì • ì›Œí¬ìŠ¤í…Œì´ì…˜ë§Œ (ì„ íƒ)
)

print(f"Group A: {len(group_a)}ëŒ€")  # 30ëŒ€ (WS01 ê¸°ì¤€)
print(f"Group B: {len(group_b)}ëŒ€")  # 30ëŒ€
```

### ìƒíƒœ ë³€ê²½

```python
# ë‹¨ì¼ ë³€ê²½
await registry.set_device_status("WS01-PB01-S05", "busy")

# ì¼ê´„ ë³€ê²½
device_ids = ["WS01-PB01-S01", "WS01-PB01-S03", "WS01-PB01-S05"]
count = await registry.set_devices_busy(device_ids)
print(f"{count}ëŒ€ busy ì²˜ë¦¬")
```

### í†µê³„ ì¡°íšŒ

```python
stats = await registry.get_device_stats(workstation_id="WS01")
# {
#     "total": 60,
#     "idle": 45,
#     "busy": 10,
#     "offline": 3,
#     "error": 2
# }
```

---

## ì°¸ê³  ìë£Œ

- [ì›Œí¬ë¡œë“œ ì‹œìŠ¤í…œ](./WORKLOAD_SYSTEM.md) - ë°°ì¹˜ ì‹¤í–‰ ìƒì„¸
- [DeviceRegistry ì†ŒìŠ¤](../../shared/device_registry.py)
- [DB ë§ˆì´ê·¸ë ˆì´ì…˜](../../shared/database/migrations/001_device_hierarchy.sql)

---

*"300ëŒ€ì˜ ê¸°ê¸°ë¥¼ í•˜ë‚˜ì˜ ìœ ê¸°ì²´ì²˜ëŸ¼ ê´€ë¦¬í•œë‹¤."*
